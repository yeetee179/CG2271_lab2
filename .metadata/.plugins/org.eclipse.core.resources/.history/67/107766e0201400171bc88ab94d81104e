#include <Arduino.h>
#include <avr/io.h>
#include <FreeRTOS.h>
#include <task.h>
#include <semphr.h>
#include <queue.h>
#define STACK_SIZE 200

QueueHandle_t queue = xQueueCreate(2, 4);

void int0task(){
	for(int i=0; i<5; i++){
	digitalWrite(7, HIGH); // Set digital I/O pin to a 1
	delay(125); // Delay
	digitalWrite(7, LOW); // Set digital I/O pin to a 0
	delay(125);
	}
}

// Flashes LED at pin 6: 5 times at 2HZ
void int1task(){
	for(int i=0; i<5; i++){
	digitalWrite(6, HIGH); // Set digital I/O pin to a 1
	delay(250); // Delay
	digitalWrite(6, LOW); // Set digital I/O pin to a 0
	delay(250);
	}
}

void setup() {
	attachInterrupt(digitalPinToInterrupt(3), int0ISR, FALLING); //deals with interrupt of pin 2
	attachInterrupt(digitalPinToInterrupt(2), int1ISR, FALLING); // deals with interrupt of pin 3
	pinMode(yellow_led_pin, OUTPUT);
	pinMode(red_led_pin, OUTPUT);
}

void loop() {
	/* create two tasks one with higher priority than the other */
	xTaskCreate(task0, "Task0", STACK_SIZE, NULL, 2, NULL);
	xTaskCreate(task1, "Task1", STACK_SIZE, NUll, 1, NULL);
	xTaskCreate(serialPrint, "SerialPrint", STACK_SIZE, NULL, 3, NULL);
	/* start scheduler */
	vTaskStartScheduler();
}

